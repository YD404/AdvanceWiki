# ADVゲーム シナリオ構文仕様書

本システムは、Googleドキュメント（またはテキストエディタ）で執筆されたシナリオをUnityで読み込み、実行するための記述ルールを定義します。

## 1. 基本ルール

- **ファイル形式と保存**:
    - **文字コード**: UTF-8
    - **改行コード**: LF または CRLF（Unity側で自動統一されます）
    - **保存場所**: Unityプロジェクトの `Assets/Resources/Scenario` フォルダ
- **読み込み順序**: ファイル名順に結合されて1つのシナリオとして扱われます。
    - **推奨ファイル名**: `01_prologue.txt`, `02_chapter1.txt` ...
- **特記事項**:
    - 各テキストファイルの **1行目は「ファイル名（識別用）」** として扱われ、ゲーム内では無視されます。
    - シナリオ本文は2行目から記述してください。

## 2. テキスト表示

### 会話（セリフ）
カギカッコ 「 または 『 を含む行は、自動的にセリフとして処理されます。

- **名前あり**: カギカッコの前に名前を書きます。
  ```
  太郎「こんにちは」
  ```
- **名前省略（話者継続）**: 名前を書かずにカギカッコから始めると、直前に喋っていたキャラクター名がそのまま表示されます。
  ```
  「昨日はよく眠れた？」
  ```

### ト書き（演出・動作）
丸カッコ （ または ( で始まる行は、ト書きとして処理されます。
名前欄は非表示になり、カッコの中身だけがテキストウィンドウに表示されます。
```
（激しい音が鳴り響く）
```

### 地の文（ナレーション）
上記のいずれにも該当しない行は、地の文として処理されます。名前欄は非表示になります。
```
雨が降り出した。
辺りは静寂に包まれている。
```

## 3. 演出コマンド

行頭の特定の記号によって、背景変更やサウンド再生を行います。
※記号は全角・半角どちらでも動作します。

### 背景変更
行頭に `○` または `@` を記述し、続けて画像ファイル名を指定します。
画像は `Resources/Images` フォルダから読み込まれます。
```
○教室
@夕暮れの公園
```

### サウンド再生
行頭に `♪` を記述し、`BGM：曲名` または `SE：音名` の形式で指定します。
音声ファイルは `Resources/Audio` フォルダから読み込まれます。

- **BGM再生**:
  ```
  ♪BGM：日常のテーマ
  ```
- **停止する場合**:
  ```
  ♪BGM：停止
  ```
- **SE（効果音）再生**:
  ```
  ♪SE：爆発音
  ```

## 4. 分岐と進行制御

### ラベル（ジャンプ先）
行頭に `*`（アスタリスク）が付いている行は、ジャンプ先の目印（ラベル）になります。
Googleドキュメントの「見出し1」設定を使用すると、書き出し時に自動的に `*` が付与されます。
```
*route_A
```

### 選択肢
`★` で始まる行に選択肢の文言を記述し、その直下の行に `→` で飛び先のラベル名を記述します。
```
★右の道を行く
→*route_right

★左の道を行く
→*route_left
```
※Unity上では、これらの行に到達した時点で選択肢ボタンが表示され、進行が停止します。

### 強制ジャンプ
選択肢を経由せず、特定のラベルへ強制的に移動させたい場合に使用します。共通ルートへ戻る際などに利用します。
```
goto *common_route
```

## 5. その他

### コメントアウト
行頭に `//` を記述すると、その行はゲーム内で無視されます。メモ書きに使用してください。
```
// ここから第2章のデータ
```

## 6. パラメータ・フラグ操作

行頭に `#` または `＃` を記述することで、ゲーム内変数の計算（好感度アップ、フラグ立て等）を行います。
この行は画面には表示されず、内部データの更新のみを行って即座に次の行へ進みます。

- **書式**:
  ```
  #変数名 演算子 数値
  ```
    - **変数名**: 任意の文字列（例: 好感度, Coin, Flag_A）
    - **演算子**: `+` (加算), `-` (減算), `=` (代入)
    - **数値**: 整数

- **記述例**:
    - **加算（好感度が上がる）**:
      ```
      #好感度 + 1
      ```
    - **減算（ダメージを受ける、お金を使う）**:
      ```
      #HP - 10
      ```
    - **代入（フラグをONにする、値をリセットする）**:
      ```
      #イベントAクリア = 1
      #好感度 = 0
      ```

## 記述サンプル

```text
Common_Route_File  <-- 1行目は無視される

// 冒頭シーン
○教室
♪BGM：学園

[先生]
「席につけー。転校生を紹介する」

（ドアが開く音）
♪SE：ドア開閉

[転校生]
「……はじめまして」

主人公「（可愛い子だな……）」

★話しかける
→*talk_event

★無視する
→*ignore_event

// --------------------
*talk_event
// --------------------
// ▼▼▼ パラメータ操作 ▼▼▼
#好感度 + 1
// ▲▲▲▲▲▲▲▲▲▲▲▲▲▲
[主人公]
「よろしくね」
[転校生]
「うん、よろしく」
goto *next_scene

// --------------------
*ignore_event
// --------------------
// ▼▼▼ パラメータ操作 ▼▼▼
#好感度 - 1
// ▲▲▲▲▲▲▲▲▲▲▲▲▲▲
[主人公]
「……」
（気まずい沈黙が流れた）
goto *next_scene

// --------------------
*next_scene
// --------------------
○廊下
（つづく）
```
